{-# LANGUAGE OverloadedStrings #-}

module InterpretorSpec (spec) where

import Interpretor

import qualified Data.ByteString.Lazy as B
import qualified Data.IntMap          as M
import qualified Data.PQueue.Min      as PQ

import Test.Hspec

spec :: Spec
spec = do
    describe "parseStateString" $ do
        it "should parse a state string with an empty map correctly" $
          parseStateString simpleStateString `shouldBe` expectedSimpleStateString
        it "should parse a state string with a map with finished towers correctly" $
          parseStateString stateStringWithFinishedTowers `shouldBe` expectedWithFinishedTowersStateString
        it "should parse a state string with a map with finished towers and towers which are under construction correctly" $
          parseStateString stateStringWithFinishedAndUnfinishedTowers `shouldBe` expectedWithFinishedAndUnfinishedTowersStateString
        it "should parse a state string with a map with finished towers, towers under which are under construction and missiles" $
          parseStateString stateStringWithFinishedAndUnfinishedTowersAndMissiles `shouldBe` expectedWithFinishedAndUnfinishedTowersStateStringAndMissiles

simpleStateString :: B.ByteString
simpleStateString = "{\"gameDetails\": {\"round\": 11,\"maxRounds\": 400,\"mapWidth\": 16,\"mapHeight\": 8,\"roundIncomeEnergy\": 5,\"buildingPrices\": {\"TESLA\": 300,\"DEFENSE\": 30,\"ATTACK\": 30,\"ENERGY\": 20},\"buildingsStats\": {\"TESLA\": {\"health\": 5,\"constructionTime\": 11,\"price\": 300,\"weaponDamage\": 20,\"weaponSpeed\": 0,\"weaponCooldownPeriod\": 10,\"energyGeneratedPerTurn\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 1},\"DEFENSE\": {\"health\": 20,\"constructionTime\": 4,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownPeriod\": 0,\"energyGeneratedPerTurn\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 1},\"ATTACK\": {\"health\": 5,\"constructionTime\": 2,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 1,\"weaponCooldownPeriod\": 3,\"energyGeneratedPerTurn\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 1},\"ENERGY\": {\"health\": 5,\"constructionTime\": 2,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownPeriod\": 0,\"energyGeneratedPerTurn\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 1}}},\"players\": [{\"playerType\": \"A\",\"energy\": 37,\"health\": 30,\"hitsTaken\": 14,\"score\": 451},{\"playerType\": \"B\",\"energy\": 53,\"health\": 100,\"hitsTaken\": 0,\"score\": 2093}],\"gameMap\": []}"

expectedSimpleStateString :: GameState
expectedSimpleStateString =
  (GameState { me      = (Player { energy            = 37,
                                                      health            = 30,
                                                      hitsTaken         = 14,
                                                      score             = 451,
                                                      towerMap          = M.empty,
                                                      constructionQueue = PQ.empty,
                                                      ownedMissiles     = [] }),
                                   oponent = (Player { energy            = 53,
                                                       health            = 100,
                                                       hitsTaken         = 0,
                                                       score             = 2093,
                                                       towerMap          = M.empty,
                                                       constructionQueue = PQ.empty,
                                                       ownedMissiles     = [] })})

stateStringWithFinishedTowers :: B.ByteString
stateStringWithFinishedTowers = "{\"gameDetails\": {\"round\": 11,\"maxRounds\": 400,\"mapWidth\": 16,\"mapHeight\": 8,\"roundIncomeEnergy\": 5,\"buildingPrices\": {\"TESLA\": 300,\"DEFENSE\": 30,\"ATTACK\": 30,\"ENERGY\": 20},\"buildingsStats\": {\"TESLA\": {\"health\": 5,\"constructionTime\": 11,\"price\": 300,\"weaponDamage\": 20,\"weaponSpeed\": 0,\"weaponCooldownPeriod\": 10,\"energyGeneratedPerTurn\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 1},\"DEFENSE\": {\"health\": 20,\"constructionTime\": 4,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownPeriod\": 0,\"energyGeneratedPerTurn\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 1},\"ATTACK\": {\"health\": 5,\"constructionTime\": 2,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 1,\"weaponCooldownPeriod\": 3,\"energyGeneratedPerTurn\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 1},\"ENERGY\": {\"health\": 5,\"constructionTime\": 2,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownPeriod\": 0,\"energyGeneratedPerTurn\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 1}}},\"players\": [{\"playerType\": \"A\",\"energy\": 37,\"health\": 30,\"hitsTaken\": 14,\"score\": 451},{\"playerType\": \"B\",\"energy\": 53,\"health\": 100,\"hitsTaken\": 0,\"score\": 2093}],\"gameMap\": [[{\"x\": 0,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 0,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 8,\"y\": 0,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 0,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 0,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 1,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 1,\"y\": 1,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 1,\"buildings\": [{\"health\": 10,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 3,\"y\": 1,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 1,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 4,\"y\": 1,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 1,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 5,\"y\": 1,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 1,\"buildings\": [{\"health\": 10,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 6,\"y\": 1,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 1,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 2,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 14,\"y\": 1,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 1,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 1,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 2,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 1,\"y\": 2,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 2,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 8,\"y\": 2,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 2,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 3,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 14,\"y\": 2,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 2,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 2,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 3,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 0,\"y\": 3,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 3,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 5,\"y\": 3,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 3,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 3,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 4,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 8,\"y\": 4,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 4,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 1,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 9,\"y\": 4,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 4,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 4,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 5,\"buildings\": [{\"health\": 15,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 8,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 1,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 9,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 10,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 2,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 11,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 3,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 12,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 13,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 2,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 14,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 6,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 3,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 9,\"y\": 6,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 6,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 6,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"}]]}"

expectedWithFinishedTowersStateString :: GameState
expectedWithFinishedTowersStateString =
  (GameState { me      = (Player { energy            = 37,
                                                      health            = 30,
                                                      hitsTaken         = 14,
                                                      score             = 451,
                                                      towerMap          = M.fromList [(1, M.fromList [(1, (Building { integrity              = 20,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = DEFENSE })),
                                                                                                      (3, (Building { integrity              = 10,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = DEFENSE })),
                                                                                                      (4, (Building { integrity              = 20,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = DEFENSE })),
                                                                                                      (5, (Building { integrity              = 20,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = DEFENSE })),
                                                                                                      (6, (Building { integrity              = 10,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = DEFENSE }))]),
                                                                                      (2, M.fromList [(1, (Building { integrity              = 5,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = DEFENSE }))]),
                                                                                      (3, M.fromList [(0, (Building { integrity              = 5,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = ENERGY })),
                                                                                                      (5, (Building { integrity              = 5,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = ENERGY }))])],
                                                      constructionQueue = PQ.empty,
                                                      ownedMissiles     = [] }),
                                   oponent = (Player { energy            = 53,
                                                       health            = 100,
                                                       hitsTaken         = 0,
                                                       score             = 2093,
                                                       towerMap          = M.fromList [(0, M.fromList [(8, (Building { integrity              = 20,
                                                                                                                       weaponCooldownTimeLeft = 0,
                                                                                                                       buildingType           = DEFENSE })),
                                                                                                       (15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))]),
                                                                                       (1, M.fromList [(14, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 2,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))]),
                                                                                       (2, M.fromList [(8, (Building { integrity              = 20,
                                                                                                                       weaponCooldownTimeLeft = 0,
                                                                                                                       buildingType           = DEFENSE })),
                                                                                                       (14, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 3,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))]),
                                                                                       (3, M.fromList [(15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))]),
                                                                                       (4, M.fromList [(8, (Building { integrity              = 20,
                                                                                                                       weaponCooldownTimeLeft = 0,
                                                                                                                       buildingType           = DEFENSE })),
                                                                                                       (9, (Building { integrity              = 5,
                                                                                                                       weaponCooldownTimeLeft = 1,
                                                                                                                       buildingType           = ATTACK })),
                                                                                                       (15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))]),
                                                                                       (5, M.fromList [(8, (Building { integrity              = 15,
                                                                                                                       weaponCooldownTimeLeft = 0,
                                                                                                                       buildingType           = DEFENSE })),
                                                                                                       (9, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 1,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (10, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (11, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 2,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (12, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 3,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (13, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (14, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 2,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))]),
                                                                                       (6, M.fromList [(9, (Building { integrity              = 5,
                                                                                                                       weaponCooldownTimeLeft = 3,
                                                                                                                       buildingType           = ATTACK })),
                                                                                                       (15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))])],
                                                       constructionQueue = PQ.empty,
                                                       ownedMissiles     = [] })})

stateStringWithFinishedAndUnfinishedTowers :: B.ByteString
stateStringWithFinishedAndUnfinishedTowers = "{\"gameDetails\": {\"round\": 11,\"maxRounds\": 400,\"mapWidth\": 16,\"mapHeight\": 8,\"roundIncomeEnergy\": 5,\"buildingPrices\": {\"TESLA\": 300,\"DEFENSE\": 30,\"ATTACK\": 30,\"ENERGY\": 20},\"buildingsStats\": {\"TESLA\": {\"health\": 5,\"constructionTime\": 11,\"price\": 300,\"weaponDamage\": 20,\"weaponSpeed\": 0,\"weaponCooldownPeriod\": 10,\"energyGeneratedPerTurn\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 1},\"DEFENSE\": {\"health\": 20,\"constructionTime\": 4,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownPeriod\": 0,\"energyGeneratedPerTurn\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 1},\"ATTACK\": {\"health\": 5,\"constructionTime\": 2,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 1,\"weaponCooldownPeriod\": 3,\"energyGeneratedPerTurn\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 1},\"ENERGY\": {\"health\": 5,\"constructionTime\": 2,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownPeriod\": 0,\"energyGeneratedPerTurn\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 1}}},\"players\": [{\"playerType\": \"A\",\"energy\": 37,\"health\": 30,\"hitsTaken\": 14,\"score\": 451},{\"playerType\": \"B\",\"energy\": 53,\"health\": 100,\"hitsTaken\": 0,\"score\": 2093}],\"gameMap\": [[{\"x\": 0,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 0,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 8,\"y\": 0,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 0,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 0,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 1,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": 1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 0,\"y\": 1,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 1,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 1,\"y\": 1,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 1,\"buildings\": [{\"health\": 10,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 3,\"y\": 1,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 1,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 4,\"y\": 1,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 1,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 5,\"y\": 1,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 1,\"buildings\": [{\"health\": 10,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 6,\"y\": 1,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 1,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 2,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 14,\"y\": 1,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 1,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 1,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 2,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 1,\"y\": 2,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 2,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 8,\"y\": 2,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 2,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 3,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 14,\"y\": 2,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 2,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 2,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 3,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 0,\"y\": 3,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 3,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 5,\"y\": 3,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 3,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": 0,\"price\": 300,\"weaponDamage\": 20,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 10,\"destroyMultiplier\": 1,\"constructionScore\": 1,\"energyGeneratedPerTurn\": 0,\"maxRange\": 9,\"buildingType\": \"TESLA\",\"energyPerShot\": 100,\"x\": 7,\"y\": 3,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 3,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": 1,\"price\": 300,\"weaponDamage\": 20,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 10,\"destroyMultiplier\": 1,\"constructionScore\": 1,\"energyGeneratedPerTurn\": 0,\"maxRange\": 9,\"buildingType\": \"TESLA\",\"energyPerShot\": 100,\"x\": 8,\"y\": 3,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 3,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 3,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 4,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 8,\"y\": 4,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 4,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 1,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 9,\"y\": 4,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 4,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 4,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 5,\"buildings\": [{\"health\": 15,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 8,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 1,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 9,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 10,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 2,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 11,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 3,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 12,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 13,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 2,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 14,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 6,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": 0,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 8,\"y\": 6,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 6,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 3,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 9,\"y\": 6,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 6,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": 0,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 10,\"y\": 6,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 6,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 6,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"}]]}"

expectedWithFinishedAndUnfinishedTowersStateString :: GameState
expectedWithFinishedAndUnfinishedTowersStateString =
  (GameState { me      = (Player { energy            = 37,
                                                      health            = 30,
                                                      hitsTaken         = 14,
                                                      score             = 451,
                                                      towerMap          = M.fromList [(1, M.fromList [(1, (Building { integrity              = 20,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = DEFENSE })),
                                                                                                      (3, (Building { integrity              = 10,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = DEFENSE })),
                                                                                                      (4, (Building { integrity              = 20,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = DEFENSE })),
                                                                                                      (5, (Building { integrity              = 20,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = DEFENSE })),
                                                                                                      (6, (Building { integrity              = 10,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = DEFENSE }))]),
                                                                                      (2, M.fromList [(1, (Building { integrity              = 5,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = DEFENSE }))]),
                                                                                      (3, M.fromList [(0, (Building { integrity              = 5,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = ENERGY })),
                                                                                                      (5, (Building { integrity              = 5,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = ENERGY }))])],
                                                      constructionQueue = PQ.fromList [(0, (7, 3), (Building { integrity              = 5,
                                                                                                               weaponCooldownTimeLeft = 0,
                                                                                                               buildingType           = TESLA })),
                                                                                       (1, (0, 1), (Building { integrity              = 20,
                                                                                                               weaponCooldownTimeLeft = 0,
                                                                                                               buildingType           = DEFENSE }))],
                                                      ownedMissiles     = [] }),
                                   oponent = (Player { energy            = 53,
                                                       health            = 100,
                                                       hitsTaken         = 0,
                                                       score             = 2093,
                                                       towerMap          = M.fromList [(0, M.fromList [(8, (Building { integrity              = 20,
                                                                                                                       weaponCooldownTimeLeft = 0,
                                                                                                                       buildingType           = DEFENSE })),
                                                                                                       (15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))]),
                                                                                       (1, M.fromList [(14, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 2,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))]),
                                                                                       (2, M.fromList [(8, (Building { integrity              = 20,
                                                                                                                       weaponCooldownTimeLeft = 0,
                                                                                                                       buildingType           = DEFENSE })),
                                                                                                       (14, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 3,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))]),
                                                                                       (3, M.fromList [(15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))]),
                                                                                       (4, M.fromList [(8, (Building { integrity              = 20,
                                                                                                                       weaponCooldownTimeLeft = 0,
                                                                                                                       buildingType           = DEFENSE })),
                                                                                                       (9, (Building { integrity              = 5,
                                                                                                                       weaponCooldownTimeLeft = 1,
                                                                                                                       buildingType           = ATTACK })),
                                                                                                       (15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))]),
                                                                                       (5, M.fromList [(8, (Building { integrity              = 15,
                                                                                                                       weaponCooldownTimeLeft = 0,
                                                                                                                       buildingType           = DEFENSE })),
                                                                                                       (9, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 1,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (10, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (11, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 2,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (12, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 3,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (13, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (14, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 2,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))]),
                                                                                       (6, M.fromList [(9, (Building { integrity              = 5,
                                                                                                                       weaponCooldownTimeLeft = 3,
                                                                                                                       buildingType           = ATTACK })),
                                                                                                       (15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))])],
                                                       constructionQueue = PQ.fromList [(0, (8, 6), (Building { integrity              = 20,
                                                                                                                weaponCooldownTimeLeft = 0,
                                                                                                                buildingType           = DEFENSE })),
                                                                                        (0, (10, 6), (Building { integrity              = 5,
                                                                                                                 weaponCooldownTimeLeft = 0,
                                                                                                                 buildingType           = ATTACK })),
                                                                                        (1, (8, 3), (Building { integrity              = 5,
                                                                                                                weaponCooldownTimeLeft = 0,
                                                                                                                buildingType           = TESLA }))],
                                                       ownedMissiles     = [] })})

stateStringWithFinishedAndUnfinishedTowersAndMissiles :: B.ByteString
stateStringWithFinishedAndUnfinishedTowersAndMissiles = "{\"gameDetails\": {\"round\": 11,\"maxRounds\": 400,\"mapWidth\": 16,\"mapHeight\": 8,\"roundIncomeEnergy\": 5,\"buildingPrices\": {\"TESLA\": 300,\"DEFENSE\": 30,\"ATTACK\": 30,\"ENERGY\": 20},\"buildingsStats\": {\"TESLA\": {\"health\": 5,\"constructionTime\": 11,\"price\": 300,\"weaponDamage\": 20,\"weaponSpeed\": 0,\"weaponCooldownPeriod\": 10,\"energyGeneratedPerTurn\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 1},\"DEFENSE\": {\"health\": 20,\"constructionTime\": 4,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownPeriod\": 0,\"energyGeneratedPerTurn\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 1},\"ATTACK\": {\"health\": 5,\"constructionTime\": 2,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 1,\"weaponCooldownPeriod\": 3,\"energyGeneratedPerTurn\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 1},\"ENERGY\": {\"health\": 5,\"constructionTime\": 2,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownPeriod\": 0,\"energyGeneratedPerTurn\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 1}}},\"players\": [{\"playerType\": \"A\",\"energy\": 37,\"health\": 30,\"hitsTaken\": 14,\"score\": 451},{\"playerType\": \"B\",\"energy\": 53,\"health\": 100,\"hitsTaken\": 0,\"score\": 2093}],\"gameMap\": [[{\"x\": 0,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 0,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 8,\"y\": 0,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 0,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 0,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 0,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 1,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": 1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 0,\"y\": 1,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 1,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 1,\"y\": 1,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 1,\"buildings\": [{\"health\": 10,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 3,\"y\": 1,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 1,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 4,\"y\": 1,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 1,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 5,\"y\": 1,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 1,\"buildings\": [{\"health\": 10,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 6,\"y\": 1,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 1,\"buildings\": [],\"missiles\": [{\"damage\": 5,\"speed\": 2,\"x\": 10,\"y\": 1,\"playerType\": \"B\"},{\"damage\": 5,\"speed\": 2,\"x\": 10,\"y\": 1,\"playerType\": \"A\"},{\"damage\": 5,\"speed\": 2,\"x\": 10,\"y\": 1,\"playerType\": \"A\"}],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 1,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 1,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 2,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 14,\"y\": 1,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 1,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 1,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 2,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 1,\"y\": 2,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 2,\"buildings\": [],\"missiles\": [{\"damage\": 5,\"speed\": 2,\"x\": 4,\"y\": 2,\"playerType\": \"B\"}],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 2,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 8,\"y\": 2,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 2,\"buildings\": [],\"missiles\": [{\"damage\": 5,\"speed\": 2,\"x\": 12,\"y\": 2,\"playerType\": \"B\"}],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 2,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 2,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 3,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 14,\"y\": 2,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 2,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 2,\"playerType\": \"B\"}],\"missiles\": [{\"damage\": 5,\"speed\": 2,\"x\": 15,\"y\": 2,\"playerType\": \"A\"}],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 3,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 0,\"y\": 3,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 3,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 5,\"y\": 3,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 3,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": 0,\"price\": 300,\"weaponDamage\": 20,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 10,\"destroyMultiplier\": 1,\"constructionScore\": 1,\"energyGeneratedPerTurn\": 0,\"maxRange\": 9,\"buildingType\": \"TESLA\",\"energyPerShot\": 100,\"x\": 7,\"y\": 3,\"playerType\": \"A\"}],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 3,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": 1,\"price\": 300,\"weaponDamage\": 20,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 10,\"destroyMultiplier\": 1,\"constructionScore\": 1,\"energyGeneratedPerTurn\": 0,\"maxRange\": 9,\"buildingType\": \"TESLA\",\"energyPerShot\": 100,\"x\": 8,\"y\": 3,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 3,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 3,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 3,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 4,\"buildings\": [],\"missiles\": [{\"damage\": 5,\"speed\": 2,\"x\": 3,\"y\": 4,\"playerType\": \"B\"}],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 4,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 8,\"y\": 4,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 4,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 1,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 9,\"y\": 4,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 4,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 4,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 4,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 5,\"buildings\": [],\"missiles\": [{\"damage\": 5,\"speed\": 2,\"x\": 2,\"y\": 5,\"playerType\": \"B\"},{\"damage\": 5,\"speed\": 2,\"x\": 2,\"y\": 5,\"playerType\": \"B\"},{\"damage\": 5,\"speed\": 2,\"x\": 2,\"y\": 5,\"playerType\": \"B\"}],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 5,\"buildings\": [],\"missiles\": [{\"damage\": 5,\"speed\": 2,\"x\": 3,\"y\": 5,\"playerType\": \"B\"}],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 5,\"buildings\": [],\"missiles\": [{\"damage\": 5,\"speed\": 2,\"x\": 5,\"y\": 5,\"playerType\": \"B\"}],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 5,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 5,\"buildings\": [],\"missiles\": [{\"damage\": 5,\"speed\": 2,\"x\": 7,\"y\": 5,\"playerType\": \"B\"}],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 5,\"buildings\": [{\"health\": 15,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 8,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 1,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 9,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 10,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [{\"damage\": 5,\"speed\": 2,\"x\": 10,\"y\": 5,\"playerType\": \"B\"},{\"damage\": 5,\"speed\": 2,\"x\": 10,\"y\": 5,\"playerType\": \"B\"}],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 2,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 11,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 3,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 12,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 13,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 2,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 14,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 5,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 5,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 6,\"buildings\": [],\"missiles\": [{\"damage\": 5,\"speed\": 2,\"x\": 7,\"y\": 6,\"playerType\": \"B\"}],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 6,\"buildings\": [{\"health\": 20,\"constructionTimeLeft\": 0,\"price\": 30,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 10,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"DEFENSE\",\"x\": 8,\"y\": 6,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 6,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 3,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 9,\"y\": 6,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 6,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": 0,\"price\": 30,\"weaponDamage\": 5,\"weaponSpeed\": 2,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 3,\"destroyMultiplier\": 1,\"constructionScore\": 15,\"energyGeneratedPerTurn\": 0,\"buildingType\": \"ATTACK\",\"x\": 10,\"y\": 6,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 6,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 6,\"buildings\": [{\"health\": 5,\"constructionTimeLeft\": -1,\"price\": 20,\"weaponDamage\": 0,\"weaponSpeed\": 0,\"weaponCooldownTimeLeft\": 0,\"weaponCooldownPeriod\": 0,\"destroyMultiplier\": 1,\"constructionScore\": 3,\"energyGeneratedPerTurn\": 3,\"buildingType\": \"ENERGY\",\"x\": 15,\"y\": 6,\"playerType\": \"B\"}],\"missiles\": [],\"cellOwner\": \"B\"}],[{\"x\": 0,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 1,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 2,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 3,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 4,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 5,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 6,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 7,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"A\"},{\"x\": 8,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 9,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 10,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 11,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 12,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 13,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 14,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"},{\"x\": 15,\"y\": 7,\"buildings\": [],\"missiles\": [],\"cellOwner\": \"B\"}]]}"

expectedWithFinishedAndUnfinishedTowersStateStringAndMissiles :: GameState
expectedWithFinishedAndUnfinishedTowersStateStringAndMissiles =
  (GameState { me      = (Player { energy            = 37,
                                                      health            = 30,
                                                      hitsTaken         = 14,
                                                      score             = 451,
                                                      towerMap          = M.fromList [(1, M.fromList [(1, (Building { integrity              = 20,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = DEFENSE })),
                                                                                                      (3, (Building { integrity              = 10,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = DEFENSE })),
                                                                                                      (4, (Building { integrity              = 20,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = DEFENSE })),
                                                                                                      (5, (Building { integrity              = 20,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = DEFENSE })),
                                                                                                      (6, (Building { integrity              = 10,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = DEFENSE }))]),
                                                                                      (2, M.fromList [(1, (Building { integrity              = 5,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = DEFENSE }))]),
                                                                                      (3, M.fromList [(0, (Building { integrity              = 5,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = ENERGY })),
                                                                                                      (5, (Building { integrity              = 5,
                                                                                                                      weaponCooldownTimeLeft = 0,
                                                                                                                      buildingType           = ENERGY }))])],
                                                      constructionQueue = PQ.fromList [(0, (7, 3), (Building { integrity              = 5,
                                                                                                               weaponCooldownTimeLeft = 0,
                                                                                                               buildingType           = TESLA })),
                                                                                       (1, (0, 1), (Building { integrity              = 20,
                                                                                                               weaponCooldownTimeLeft = 0,
                                                                                                               buildingType           = DEFENSE }))],
                                                      ownedMissiles     =  [
                                                          (Missile 15 2),
                                                          (Missile 10 1),
                                                          (Missile 10 1)
                                                        ]}),
                                   oponent = (Player { energy            = 53,
                                                       health            = 100,
                                                       hitsTaken         = 0,
                                                       score             = 2093,
                                                       towerMap          = M.fromList [(0, M.fromList [(8, (Building { integrity              = 20,
                                                                                                                       weaponCooldownTimeLeft = 0,
                                                                                                                       buildingType           = DEFENSE })),
                                                                                                       (15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))]),
                                                                                       (1, M.fromList [(14, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 2,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))]),
                                                                                       (2, M.fromList [(8, (Building { integrity              = 20,
                                                                                                                       weaponCooldownTimeLeft = 0,
                                                                                                                       buildingType           = DEFENSE })),
                                                                                                       (14, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 3,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))]),
                                                                                       (3, M.fromList [(15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))]),
                                                                                       (4, M.fromList [(8, (Building { integrity              = 20,
                                                                                                                       weaponCooldownTimeLeft = 0,
                                                                                                                       buildingType           = DEFENSE })),
                                                                                                       (9, (Building { integrity              = 5,
                                                                                                                       weaponCooldownTimeLeft = 1,
                                                                                                                       buildingType           = ATTACK })),
                                                                                                       (15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))]),
                                                                                       (5, M.fromList [(8, (Building { integrity              = 15,
                                                                                                                       weaponCooldownTimeLeft = 0,
                                                                                                                       buildingType           = DEFENSE })),
                                                                                                       (9, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 1,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (10, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (11, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 2,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (12, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 3,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (13, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (14, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 2,
                                                                                                                        buildingType           = ATTACK })),
                                                                                                       (15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))]),
                                                                                       (6, M.fromList [(9, (Building { integrity              = 5,
                                                                                                                       weaponCooldownTimeLeft = 3,
                                                                                                                       buildingType           = ATTACK })),
                                                                                                       (15, (Building { integrity              = 5,
                                                                                                                        weaponCooldownTimeLeft = 0,
                                                                                                                        buildingType           = ENERGY }))])],
                                                       constructionQueue = PQ.fromList [(0, (8, 6), (Building { integrity              = 20,
                                                                                                                weaponCooldownTimeLeft = 0,
                                                                                                                buildingType           = DEFENSE })),
                                                                                        (0, (10, 6), (Building { integrity              = 5,
                                                                                                                 weaponCooldownTimeLeft = 0,
                                                                                                                 buildingType           = ATTACK })),
                                                                                        (1, (8, 3), (Building { integrity              = 5,
                                                                                                                weaponCooldownTimeLeft = 0,
                                                                                                                buildingType           = TESLA }))],
                                                       ownedMissiles     = [
                                                           (Missile 7 6),
                                                           (Missile 10 5),
                                                           (Missile 10 5),
                                                           (Missile 7 5),
                                                           (Missile 5 5),
                                                           (Missile 3 5),
                                                           (Missile 2 5),
                                                           (Missile 2 5),
                                                           (Missile 2 5),
                                                           (Missile 3 4),
                                                           (Missile 12 2),
                                                           (Missile 4 2),
                                                           (Missile 10 1)
                                                         ] })})
